<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><title>量変えるとき用</title><style>body{margin:0;padding:2rem;width:95%;font-family:sans-serif}table{border-collapse:collapse;width:100%;margin-bottom:1rem}th,td{border:1px solid #ccc;padding:0.3rem;text-align:center}thead{background:#eee}input{width:50px;text-align:right}.bar-container{width:100px;height:16px;background:#eee;border-radius:8px;overflow:hidden;display:inline-block;vertical-align:middle}.bar-fill{height:100%;border-radius:8px}.container{display:flex;gap:1rem;flex-wrap:wrap}.column{flex:1;min-width:300px}label{margin-right:1rem}</style></head><body><h1>量変えるとき用</h1><p><a href="https://uphilltigger.github.io/-2/" target="_blank">普段はこちら</a></p><div class="container"><div class="column"><h2>Before</h2><label>体重：<select id="weight-left"><option value="400">400</option><option value="450">450</option><option value="500" selected>500</option></select></label><label>運動強度：<select id="work-left"><option>無</option><option>軽</option><option selected>中</option><option>強</option></select></label><table><thead><tr><th>飼料名</th><th>朝夕</th><th>昼夜</th><th>合計</th></tr></thead><tbody id="feed-body-left"></tbody></table><div id="result-left"></div><div id="result-balance-left"></div></div><div class="column"><h2>After</h2><label>運動強度：<select id="work-right"><option>無</option><option>軽</option><option selected>中</option><option>強</option></select></label><table><thead><tr><th>飼料名</th><th>朝夕</th><th>昼夜</th><th>合計</th></tr></thead><tbody id="feed-body-right"></tbody></table><div id="result-right"></div><div id="result-balance-right"></div></div></div><script>
const feeds=[{name:"ビート",DE:2.85,CP:109,Lys:7.2,Ca:5.11,P:0.78,Mg:2.68,Na:1.04,K:4.16,Fe:519.6,Cu:9.27,Zn:27.71,Mn:53.69,Se:0,Co:0.2,VA:0,VD:0,VE:0,default1:0,default2:0},{name:"燕麦",DE:2.76,CP:106.58,Lys:5.6,Ca:0.45,P:3.01,Mg:1.22,Na:0.34,K:3.55,Fe:44.01,Cu:3.52,Zn:31.6,Mn:45.61,Se:0.05,Co:0.11,VA:5,VD:0,VE:4,default1:0,default2:0.7},{name:"乾草",DE:1.35,CP:57,Lys:2.7,Ca:0,P:0,Mg:0,Na:0,K:0,Fe:81.3,Cu:7.07,Zn:21.95,Mn:94.31,Se:0,Co:0.03,VA:0,VD:0,VE:75,default1:1,default2:1}];
const reqTable=[{weight:500,work:"無",DE:16.4,CP:656,Lys:28.21,Ca:20,P:14,Mg:7.5,Na:10,K:25,Fe:400,Cu:150,Zn:450,Mn:450,Se:1.88,Co:0.5,VA:20000,VD:3300,VE:800},{weight:500,work:"中",DE:22.96,CP:918.4,Lys:39.49,Ca:35,P:21,Mg:10.56,Na:26.25,K:61.25,Fe:450,Cu:168.75,Zn:506.25,Mn:506.25,Se:2.81,Co:0.56,VA:22500,VD:3300,VE:900}];
function getRequirements(weight,work){return reqTable.find(r=>r.weight==weight&&r.work==work)||reqTable[0]}
function createRows(id){const t=document.getElementById(id);feeds.forEach(f=>{const r=document.createElement("tr");r.innerHTML=`<td>${f.name}</td><td><input type="number" class="feed-amount1" value="${f.default1}" step="0.1" min="0">kg</td><td><input type="number" class="feed-amount2" value="${f.default2}" step="0.1" min="0">kg</td><td><input type="number" class="feed-total" value="0" readonly>kg</td>`;t.appendChild(r);const i1=r.querySelector(".feed-amount1"),i2=r.querySelector(".feed-amount2"),tot=r.querySelector(".feed-total");function up(){const v1=parseFloat(i1.value)||0,v2=parseFloat(i2.value)||0;tot.value=(v1+v2).toFixed(2);calculate()}i1.addEventListener("input",up);i2.addEventListener("input",up);up()})}
function calculate(){const weight=parseInt(document.getElementById("weight-left").value),workLeft=document.getElementById("work-left").value,workRight=document.getElementById("work-right").value;["left","right"].forEach(side=>{let sum={DE:0,CP:0,Lys:0,Ca:0,P:0,Mg:0,Na:0,K:0,Fe:0,Cu:0,Zn:0,Mn:0,Se:0,Co:0,VA:0,VD:0,VE:0},totFeed=0;document.querySelectorAll(`#feed-body-${side} tr`).forEach((tr,i)=>{const t=parseFloat(tr.querySelector(".feed-total").value||0);totFeed+=t;for(const k in sum)sum[k]+=feeds[i][k]*t});const w=(side=="left")?workLeft:workRight,req=getRequirements(weight,w),ca_p=sum.Ca/sum.P,zn_cu=sum.Zn/sum.Cu,total_bw=totFeed/weight*100;function colorize(v,min,max){return v<min?"blue":v>max?"red":"green"};let html="<table><thead><tr><th>栄養素</th><th>要求量</th><th>給餌量</th><th>充足率</th><th></th></tr></thead><tbody>";for(const k in sum){const rate=sum[k]/req[k]*100,cl=rate>120?"red":rate<80?"blue":"green";html+=`<tr><td>${k}</td><td style="text-align:right">${req[k]}</td><td style="text-align:right">${sum[k].toFixed(2)}</td><td><div class="bar-container"><div class="bar-fill" style="width:${Math.min(rate,150)}%;background:${cl}"></div></div></td><td style="color:${cl};text-align:right">${rate.toFixed(1)}%</td></tr>`}html+="</tbody></table>";document.getElementById(`result-${side}`).innerHTML=html;let hb=`<table><thead><tr><th>値</th><th>理想</th><th>計算結果</th></tr></thead><tbody><tr><td>Ca/P</td><td>1.5~2.0</td><td style="color:${colorize(ca_p,1.5,2.0)};text-align:right">${ca_p.toFixed(1)}</td></tr><tr><td>Zn/Cu</td><td>3~6</td><td style="color:${colorize(zn_cu,3,6)};text-align:right">${zn_cu.toFixed(1)}</td></tr><tr><td>体重比</td><td>1.5~2.5%</td><td style="color:${colorize(total_bw,1.5,2.5)};text-align:right">${total_bw.toFixed(1)}%</td></tr></tbody></table>`;document.getElementById(`result-balance-${side}`).innerHTML=hb})}
window.onload=()=>{createRows("feed-body-left");createRows("feed-body-right");calculate()};document.getElementById("weight-left").onchange=calculate;document.getElementById("work-left").onchange=calculate;document.getElementById("work-right").onchange=calculate;
</script></body></html>
